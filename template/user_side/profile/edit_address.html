{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Address</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1f2937',
                        secondary: '#6b7280',
                        accent: '#3b82f6'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 min-h-screen py-8">
    <div class="max-w-2xl mx-auto px-4">
        <div class="mb-8">
            <h1 class="text-2xl font-semibold text-gray-900">Edit Address</h1>
        </div>

        <!-- Back Button -->
        <a href="{% url 'profile' %}" class="flex items-center text-gray-600 hover:text-gray-800 transition-colors mb-4 w-fit">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Back to Profile
        </a>

        <!-- Messages -->
        {% if messages %}
        <div class="mb-4 space-y-2">
            {% for message in messages %}
            <div class="{% if message.tags == 'error' %}bg-red-50 border-red-200 text-red-800{% elif message.tags == 'success' %}bg-green-50 border-green-200 text-green-800{% else %}bg-blue-50 border-blue-200 text-blue-800{% endif %} border px-4 py-3 rounded-lg">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <form method="POST" class="space-y-6">
                {% csrf_token %}
                
                <!-- Country -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Country/Region <span class="text-red-500">*</span>
                    </label>
                    <div class="relative">
                        <select name="country" class="w-full px-3 py-2 border {% if errors.country %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white">
                            <option value="Select Country">Select Country</option>
                            {% for country_code, country_name in address.COUNTRY_CHOICES %}
                            <option value="{{ country_code }}" 
                                {% if form_data.country == country_code %}selected
                                {% elif not form_data and address.country == country_code %}selected{% endif %}>
                                {{ country_name }}
                            </option>
                            {% endfor %}
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                    </div>
                    {% if errors.country %}
                    <p class="mt-1 text-sm text-red-500">{{ errors.country }}</p>
                    {% endif %}
                </div>

                <!-- Full Name & Mobile Number -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Full name <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="full_name" 
                            value="{% if form_data.full_name %}{{ form_data.full_name }}{% else %}{{ address.full_name }}{% endif %}"
                            class="w-full px-3 py-2 border {% if errors.full_name %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.full_name %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.full_name }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Mobile number <span class="text-red-500">*</span>
                        </label>
                        <input type="tel" name="mobile_number" 
                            value="{% if form_data.mobile_number %}{{ form_data.mobile_number }}{% else %}{{ address.mobile_number }}{% endif %}"
                            class="w-full px-3 py-2 border {% if errors.mobile_number %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.mobile_number %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.mobile_number }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Pincode & Area/Street -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Pincode <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="pincode" 
                            value="{% if form_data.pincode %}{{ form_data.pincode }}{% else %}{{ address.pincode }}{% endif %}"
                            maxlength="6"
                            class="w-full px-3 py-2 border {% if errors.pincode %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.pincode %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.pincode }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Area, Street, Sector, Village <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="area_street" 
                            value="{% if form_data.area_street %}{{ form_data.area_street }}{% else %}{{ address.area_street }}{% endif %}"
                            class="w-full px-3 py-2 border {% if errors.area_street %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.area_street %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.area_street }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Flat/House & Landmark -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Flat, House no., Building, Company, Apartment <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="flat_house" 
                            value="{% if form_data.flat_house %}{{ form_data.flat_house }}{% else %}{{ address.flat_house }}{% endif %}"
                            class="w-full px-3 py-2 border {% if errors.flat_house %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.flat_house %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.flat_house }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Landmark</label>
                        <input type="text" name="landmark" 
                            value="{% if form_data.landmark %}{{ form_data.landmark }}{% else %}{{ address.landmark|default:'' }}{% endif %}"
                            placeholder="Optional"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>

                <!-- Town/City & State -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Town/City <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="town_city" 
                            value="{% if form_data.town_city %}{{ form_data.town_city }}{% else %}{{ address.town_city }}{% endif %}"
                            class="w-full px-3 py-2 border {% if errors.town_city %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.town_city %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.town_city }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            State <span class="text-red-500">*</span>
                        </label>
                        <div class="relative">
                            <select name="state" class="w-full px-3 py-2 border {% if errors.state %}border-red-500{% else %}border-gray-300{% endif %} rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white">
                                <option value="Select">Select</option>
                                {% for state_code, state_name in address.STATE_CHOICES %}
                                <option value="{{ state_code }}" 
                                    {% if form_data.state == state_code %}selected
                                    {% elif not form_data and address.state == state_code %}selected{% endif %}>
                                    {{ state_name }}
                                </option>
                                {% endfor %}
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                        </div>
                        {% if errors.state %}
                        <p class="mt-1 text-sm text-red-500">{{ errors.state }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Address Type -->
                <div class="bg-gray-50 rounded-lg border border-gray-200 p-4">
                    <h3 class="text-sm font-medium text-gray-900 mb-3">
                        Address Type <span class="text-red-500">*</span>
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        {% for type_code, type_display in address.ADDRESS_TYPE_CHOICES %}
                        <label class="flex items-center">
                            <input type="radio" name="address_type" value="{{ type_code }}" 
                                {% if form_data.address_type == type_code %}checked
                                {% elif not form_data and address.address_type == type_code %}checked{% endif %}
                                class="sr-only peer">
                            <div class="px-4 py-2 border border-gray-300 rounded-full text-sm cursor-pointer hover:bg-gray-50 peer-checked:bg-blue-50 peer-checked:border-blue-500 peer-checked:text-blue-700 transition-colors">
                                {{ type_display }}
                            </div>
                        </label>
                        {% endfor %}
                    </div>
                    {% if errors.address_type %}
                    <p class="mt-2 text-sm text-red-500">{{ errors.address_type }}</p>
                    {% endif %}
                </div>

                <!-- Default Address Checkbox -->
                <div class="flex items-center">
                    <input type="checkbox" name="is_default" id="default-address" 
                        {% if form_data.is_default %}checked
                        {% elif not form_data and address.is_default %}checked{% endif %}
                        class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                    <label for="default-address" class="ml-2 text-sm text-gray-700">
                        Make this my default address
                    </label>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-3 pt-6">
                    <button type="submit" class="flex-1 bg-black text-white py-3 px-6 rounded-md font-medium hover:bg-gray-800 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
                        Update Address
                    </button>
                    <a href="{% url 'profile' %}" class="flex-1 bg-white text-gray-700 py-3 px-6 rounded-md font-medium border border-gray-300 hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 text-center">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</body>
</html>