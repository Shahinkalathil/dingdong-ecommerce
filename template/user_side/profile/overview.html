{% extends 'user_side/profile/profile_base.html' %}
{% load static %}

{% block scripts  %}
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1f2937',
                        secondary: '#374151',
                        accent: '#3b82f6',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444'
                    }
                }
            }
        }
    </script>
    <style>
        .hover-popup {
            position: relative;
        }
        .hover-popup::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6, #06b6d4);
            border-radius: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }
        .hover-popup:hover::before {
            opacity: 1;
        }
        .profile-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
    </style>
    {% endblock %}

{% block content %}
 <!-- Main Content -->

    <section class="flex-1 p-6 lg:p-10">
              <div class="text-3xl font-bold text-center">
      <a href="{% url 'home' %}" class="text-black no-underline hover:text-gray-800">DINGDONG</a>
    </div>
        <div class="space-y-8">


                <!-- Overview Section -->
                <div id="overview" class="bg-white rounded-lg shadow-sm border p-6 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Account Overview</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="hover-popup bg-gradient-to-br from-accent to-blue-600 text-white p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-blue-100">Total Orders</p>
                                    <p class="text-2xl font-bold">24</p>
                                </div>
                                <svg class="w-8 h-8 text-blue-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <div class="hover-popup bg-gradient-to-br from-success to-green-600 text-white p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-green-100">Wallet Balance</p>
                                    <p class="text-2xl font-bold">₹2,450</p>
                                </div>
                                <svg class="w-8 h-8 text-green-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <div class="hover-popup bg-gradient-to-br from-warning to-yellow-600 text-white p-6 rounded-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-yellow-100">Reward Points</p>
                                    <p class="text-2xl font-bold">1,250</p>
                                </div>
                                <svg class="w-8 h-8 text-yellow-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Orders -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Orders</h3>
                        <div class="space-y-4">
                            <div class="hover-popup border rounded-lg p-4 hover:shadow-md transition-all duration-200">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <img src="/placeholder.svg?height=60&width=60" alt="Product" class="w-15 h-15 rounded-lg object-cover">
                                        <div>
                                            <h4 class="font-medium text-gray-900">Casio G-Shock Digital Watch</h4>
                                            <p class="text-sm text-gray-500">Order #ORD-2024-001</p>
                                            <p class="text-sm text-gray-500">Delivered on Jan 15, 2024</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-semibold text-gray-900">₹1,795</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success/10 text-success">
                                            Delivered
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="hover-popup border rounded-lg p-4 hover:shadow-md transition-all duration-200">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <img src="/placeholder.svg?height=60&width=60" alt="Product" class="w-15 h-15 rounded-lg object-cover">
                                        <div>
                                            <h4 class="font-medium text-gray-900">Wireless Bluetooth Headphones</h4>
                                            <p class="text-sm text-gray-500">Order #ORD-2024-002</p>
                                            <p class="text-sm text-gray-500">Expected delivery: Jan 25, 2024</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-semibold text-gray-900">₹2,999</p>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-accent/10 text-accent">
                                            In Transit
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Details Section -->
                <div id="profile" class="bg-white rounded-lg shadow-sm border p-6 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Profile Details</h2>

                        <a href="{% url 'edit_profile' user.id %}" 
                            class="hover-popup bg-accent text-white px-4 py-2 rounded-md hover:bg-accent/90 transition-colors duration-200">
                            EDIT
                        </a>
                        
                    </div>
                    <div>
                        {% if messages %}
                        <div class="p-4 rounded-md mt-4">
                            {% for message in messages %}
                                <p class="text-sm {% if message.tags == 'error' %}text-red-600{% else %}text-green-600{% endif %}">
                                    {{ message }}
                                </p>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="profile-card rounded-lg p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Full Name</label>
                                    <p class="text-lg font-semibold text-gray-900">
                                        {% if user.fullname %}
                                            {{ user.fullname }}
                                        {% else %}
                                            Shahin
                                        {% endif %}
                                    </p>
                                </div>
                                
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Mobile Number</label>
                                    <p class="text-lg font-semibold text-gray-900">{{ user.phone }}</p>
                                </div>
                                
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Email ID</label>
                                    <p class="text-lg font-semibold text-gray-900">{{ user.email }}</p>
                                </div>
                                
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Gender</label>
                                    <p class="text-lg font-semibold text-gray-900">
                                        {% if user.gender %}
                                            {{ user.gender }}
                                        {% else %}
                                            - not added -
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                            
                            <div class="space-y-4">
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Date of Birth</label>
                                    <p class="text-lg font-semibold text-gray-500">
                                        {% if user.dob %}
                                            {{ user.dob|date:"d M Y" }}
                                        {% else %}
                                            - not added -
                                        {% endif %}
                                    </p>
                                </div>
                                
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Location</label>
                                    <p class="text-lg font-semibold text-gray-500">
                                        {% if user.location %}
                                            {{ user.location }}
                                        {% else %}
                                            - not added -
                                        {% endif %}
                                    </p>
                                </div>
                                
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Alternate Mobile</label>
                                    <p class="text-lg font-semibold text-gray-500">
                                        {% if user.alt_phone %}
                                            {{ user.alt_phone }}
                                        {% else %}
                                            - not added -
                                        {% endif %}
                                    </p>
                                </div>
                                
                                <div class="hover-popup p-4 bg-white rounded-lg border hover:shadow-md transition-all duration-200">
                                    <label class="block text-sm font-medium text-gray-500 mb-1">Member Since</label>
                                    <p class="text-lg font-semibold text-gray-900">{{ user.created_at|date:"F Y" }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Addresses Section -->
                <div id="addresses" class="bg-white rounded-lg shadow-sm border p-6 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Saved Addresses</h2>
                        <a href="{% url 'add_address' %}" class="hover-popup bg-success text-white px-4 py-2 rounded-md hover:bg-success/90 transition-colors duration-200">
                            + Add New Address
                        </a>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="hover-popup border-2 border-accent bg-accent/5 rounded-lg p-6">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex gap-2">
                                    <h3 class="font-semibold text-gray-900">Home</h3>
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-accent text-white mb-2">
                                          Default
                                      </span>
                                </div>
                                <a href="{% url 'edit_address' %}" class="text-gray-400 hover:text-gray-600">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                </a>
                            </div>
                            <p class="text-gray-700 mb-2">John Cena</p>
                            <p class="text-gray-600 text-sm leading-relaxed">
                                123 Main Street, Apartment 4B<br>
                                New York, NY 10001<br>
                                United States
                            </p>
                            <p class="text-gray-600 text-sm mt-2">Phone: +1 (555) 123-4567</p>
                        </div>
                        
                        <div class="hover-popup border rounded-lg p-6 hover:shadow-md transition-all duration-200">
                            <div class="flex items-start justify-between mb-4">
                                <h3 class="font-semibold text-gray-900">Office</h3>
                                <button class="text-gray-400 hover:text-gray-600">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                </button>
                            </div>
                            <p class="text-gray-700 mb-2">John Cena</p>
                            <p class="text-gray-600 text-sm leading-relaxed">
                                456 Business Ave, Suite 789<br>
                                Manhattan, NY 10005<br>
                                United States
                            </p>
                            <p class="text-gray-600 text-sm mt-2">Phone: +1 (555) 987-6543</p>
                        </div>
                    </div>
                </div>

                <!-- Security Section -->
                <div id="security" class="bg-white rounded-lg shadow-sm border p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Security Settings</h2>
                    
                    <div class="space-y-6">
                        <div class="hover-popup border rounded-lg p-6 hover:shadow-md transition-all duration-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-semibold text-gray-900 mb-1">Password</h3>
                                    <p class="text-sm text-gray-500">Last changed 3 months ago</p>
                                </div>
                                <button 
                                    id="openModalBtn"
                                    class="bg-accent text-white px-4 py-2 rounded-md hover:bg-accent/90 transition-colors duration-200">
                                    Change Password
                                </button>
                            </div>
                        </div>
                        
                        <div class="hover-popup border rounded-lg p-6 hover:shadow-md transition-all duration-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-semibold text-gray-900 mb-1">Two-Factor Authentication</h3>
                                    <p class="text-sm text-gray-500">Add an extra layer of security to your account</p>
                                </div>
                                <button class="bg-success text-white px-4 py-2 rounded-md hover:bg-success/90 transition-colors duration-200">
                                    Enable 2FA
                                </button>
                            </div>
                        </div>
                        
                        <div class="hover-popup border rounded-lg p-6 hover:shadow-md transition-all duration-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-semibold text-gray-900 mb-1">Login Activity</h3>
                                    <p class="text-sm text-gray-500">Monitor your account access</p>
                                </div>
                                <button class="bg-accent text-white px-4 py-2 rounded-md hover:bg-accent/90 transition-colors duration-200">
                                    View Activity
                                </button>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Modal Overlay -->
                <div 
                    id="passwordModal" 
                    class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 transition-opacity duration-300"
                >
                    <!-- Modal Content -->
                    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 transform transition-all duration-300 scale-95 opacity-0" id="modalContent">
                        
                        <!-- Modal Header -->
                        <div class="flex items-center justify-between p-6 border-b border-gray-200">
                            <h2 class="text-xl font-semibold text-gray-800">Change Password</h2>
                            <button 
                                id="closeModalBtn" 
                                class="text-gray-400 hover:text-gray-600 transition-colors duration-200"
                            >
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>

                        <!-- Modal Body -->
                        <div class="p-6">
                            <form id="passwordForm" class="space-y-4">
                                
                                <!-- Old Password -->
                                <div>
                                    <label for="oldPassword" class="block text-sm font-medium text-gray-700 mb-2">
                                        Old Password
                                    </label>
                                    <input 
                                        type="password" 
                                        id="oldPassword" 
                                        name="oldPassword"
                                        placeholder="old password"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 outline-none"
                                        required
                                    >
                                </div>

                                <!-- New Password -->
                                <div>
                                    <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-2">
                                        New Password
                                    </label>
                                    <input 
                                        type="password" 
                                        id="newPassword" 
                                        name="newPassword"
                                        placeholder="new password"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 outline-none"
                                        required
                                    >
                                </div>

                                <!-- Confirm New Password -->
                                <div>
                                    <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">
                                        Confirm New Password
                                    </label>
                                    <input 
                                        type="password" 
                                        id="confirmPassword" 
                                        name="confirmPassword"
                                        placeholder="confirm new password"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 outline-none"
                                        required
                                    >
                                </div>

                                <!-- Save Button -->
                                <div class="pt-4">
                                    <button 
                                        type="submit"
                                        class="w-full bg-black hover:bg-gray-800 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200"
                                    >
                                        Save
                                    </button>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
        </section>
    </main>
    <script>
        // Modal Elements
        const modal = document.getElementById('passwordModal');
        const modalContent = document.getElementById('modalContent');
        const openBtn = document.getElementById('openModalBtn');
        const closeBtn = document.getElementById('closeModalBtn');
        const form = document.getElementById('passwordForm');

        // Open Modal Function
        function openModal() {
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            // Trigger animation
            setTimeout(() => {
                modal.classList.remove('bg-opacity-50');
                modal.classList.add('bg-opacity-50');
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // Close Modal Function
        function closeModal() {
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                // Reset form
                form.reset();
            }, 300);
        }

        // Event Listeners
        openBtn.addEventListener('click', openModal);
        closeBtn.addEventListener('click', closeModal);

        // Close modal when clicking outside
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                closeModal();
            }
        });

        // Form Submit Handler
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const oldPassword = document.getElementById('oldPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Basic validation
            if (newPassword !== confirmPassword) {
                alert('New passwords do not match!');
                return;
            }

            if (newPassword.length < 6) {
                alert('New password must be at least 6 characters long!');
                return;
            }

            // Here you would typically send the data to your server
            console.log('Password change submitted:', {
                oldPassword,
                newPassword,
                confirmPassword
            });

            alert('Password changed successfully!');
            closeModal();
        });
    setTimeout(function(){
        const msgDiv = document.querySelector('.p-4.rounded-md');
        if (msgDiv) {
            msgDiv.style.display = "none";
        }
    }, 5000); // Hide after 5 seconds


    </script>
{% endblock %}